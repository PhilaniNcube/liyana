revoke delete on table "public"."api_checks" from "anon";

revoke insert on table "public"."api_checks" from "anon";

revoke references on table "public"."api_checks" from "anon";

revoke select on table "public"."api_checks" from "anon";

revoke trigger on table "public"."api_checks" from "anon";

revoke truncate on table "public"."api_checks" from "anon";

revoke update on table "public"."api_checks" from "anon";

revoke delete on table "public"."api_checks" from "authenticated";

revoke insert on table "public"."api_checks" from "authenticated";

revoke references on table "public"."api_checks" from "authenticated";

revoke select on table "public"."api_checks" from "authenticated";

revoke trigger on table "public"."api_checks" from "authenticated";

revoke truncate on table "public"."api_checks" from "authenticated";

revoke update on table "public"."api_checks" from "authenticated";

revoke delete on table "public"."api_checks" from "service_role";

revoke insert on table "public"."api_checks" from "service_role";

revoke references on table "public"."api_checks" from "service_role";

revoke select on table "public"."api_checks" from "service_role";

revoke trigger on table "public"."api_checks" from "service_role";

revoke truncate on table "public"."api_checks" from "service_role";

revoke update on table "public"."api_checks" from "service_role";

revoke delete on table "public"."applications" from "anon";

revoke insert on table "public"."applications" from "anon";

revoke references on table "public"."applications" from "anon";

revoke select on table "public"."applications" from "anon";

revoke trigger on table "public"."applications" from "anon";

revoke truncate on table "public"."applications" from "anon";

revoke update on table "public"."applications" from "anon";

revoke delete on table "public"."applications" from "authenticated";

revoke insert on table "public"."applications" from "authenticated";

revoke references on table "public"."applications" from "authenticated";

revoke select on table "public"."applications" from "authenticated";

revoke trigger on table "public"."applications" from "authenticated";

revoke truncate on table "public"."applications" from "authenticated";

revoke update on table "public"."applications" from "authenticated";

revoke delete on table "public"."applications" from "service_role";

revoke insert on table "public"."applications" from "service_role";

revoke references on table "public"."applications" from "service_role";

revoke select on table "public"."applications" from "service_role";

revoke trigger on table "public"."applications" from "service_role";

revoke truncate on table "public"."applications" from "service_role";

revoke update on table "public"."applications" from "service_role";

revoke delete on table "public"."approved_loans" from "anon";

revoke insert on table "public"."approved_loans" from "anon";

revoke references on table "public"."approved_loans" from "anon";

revoke select on table "public"."approved_loans" from "anon";

revoke trigger on table "public"."approved_loans" from "anon";

revoke truncate on table "public"."approved_loans" from "anon";

revoke update on table "public"."approved_loans" from "anon";

revoke delete on table "public"."approved_loans" from "authenticated";

revoke insert on table "public"."approved_loans" from "authenticated";

revoke references on table "public"."approved_loans" from "authenticated";

revoke select on table "public"."approved_loans" from "authenticated";

revoke trigger on table "public"."approved_loans" from "authenticated";

revoke truncate on table "public"."approved_loans" from "authenticated";

revoke update on table "public"."approved_loans" from "authenticated";

revoke delete on table "public"."approved_loans" from "service_role";

revoke insert on table "public"."approved_loans" from "service_role";

revoke references on table "public"."approved_loans" from "service_role";

revoke select on table "public"."approved_loans" from "service_role";

revoke trigger on table "public"."approved_loans" from "service_role";

revoke truncate on table "public"."approved_loans" from "service_role";

revoke update on table "public"."approved_loans" from "service_role";

revoke delete on table "public"."claim_payouts" from "anon";

revoke insert on table "public"."claim_payouts" from "anon";

revoke references on table "public"."claim_payouts" from "anon";

revoke select on table "public"."claim_payouts" from "anon";

revoke trigger on table "public"."claim_payouts" from "anon";

revoke truncate on table "public"."claim_payouts" from "anon";

revoke update on table "public"."claim_payouts" from "anon";

revoke delete on table "public"."claim_payouts" from "authenticated";

revoke insert on table "public"."claim_payouts" from "authenticated";

revoke references on table "public"."claim_payouts" from "authenticated";

revoke select on table "public"."claim_payouts" from "authenticated";

revoke trigger on table "public"."claim_payouts" from "authenticated";

revoke truncate on table "public"."claim_payouts" from "authenticated";

revoke update on table "public"."claim_payouts" from "authenticated";

revoke delete on table "public"."claim_payouts" from "service_role";

revoke insert on table "public"."claim_payouts" from "service_role";

revoke references on table "public"."claim_payouts" from "service_role";

revoke select on table "public"."claim_payouts" from "service_role";

revoke trigger on table "public"."claim_payouts" from "service_role";

revoke truncate on table "public"."claim_payouts" from "service_role";

revoke update on table "public"."claim_payouts" from "service_role";

revoke delete on table "public"."claims" from "anon";

revoke insert on table "public"."claims" from "anon";

revoke references on table "public"."claims" from "anon";

revoke select on table "public"."claims" from "anon";

revoke trigger on table "public"."claims" from "anon";

revoke truncate on table "public"."claims" from "anon";

revoke update on table "public"."claims" from "anon";

revoke delete on table "public"."claims" from "authenticated";

revoke insert on table "public"."claims" from "authenticated";

revoke references on table "public"."claims" from "authenticated";

revoke select on table "public"."claims" from "authenticated";

revoke trigger on table "public"."claims" from "authenticated";

revoke truncate on table "public"."claims" from "authenticated";

revoke update on table "public"."claims" from "authenticated";

revoke delete on table "public"."claims" from "service_role";

revoke insert on table "public"."claims" from "service_role";

revoke references on table "public"."claims" from "service_role";

revoke select on table "public"."claims" from "service_role";

revoke trigger on table "public"."claims" from "service_role";

revoke truncate on table "public"."claims" from "service_role";

revoke update on table "public"."claims" from "service_role";

revoke delete on table "public"."documents" from "anon";

revoke insert on table "public"."documents" from "anon";

revoke references on table "public"."documents" from "anon";

revoke select on table "public"."documents" from "anon";

revoke trigger on table "public"."documents" from "anon";

revoke truncate on table "public"."documents" from "anon";

revoke update on table "public"."documents" from "anon";

revoke delete on table "public"."documents" from "authenticated";

revoke insert on table "public"."documents" from "authenticated";

revoke references on table "public"."documents" from "authenticated";

revoke select on table "public"."documents" from "authenticated";

revoke trigger on table "public"."documents" from "authenticated";

revoke truncate on table "public"."documents" from "authenticated";

revoke update on table "public"."documents" from "authenticated";

revoke delete on table "public"."documents" from "service_role";

revoke insert on table "public"."documents" from "service_role";

revoke references on table "public"."documents" from "service_role";

revoke select on table "public"."documents" from "service_role";

revoke trigger on table "public"."documents" from "service_role";

revoke truncate on table "public"."documents" from "service_role";

revoke update on table "public"."documents" from "service_role";

revoke delete on table "public"."funeral_policies" from "anon";

revoke insert on table "public"."funeral_policies" from "anon";

revoke references on table "public"."funeral_policies" from "anon";

revoke select on table "public"."funeral_policies" from "anon";

revoke trigger on table "public"."funeral_policies" from "anon";

revoke truncate on table "public"."funeral_policies" from "anon";

revoke update on table "public"."funeral_policies" from "anon";

revoke delete on table "public"."funeral_policies" from "authenticated";

revoke insert on table "public"."funeral_policies" from "authenticated";

revoke references on table "public"."funeral_policies" from "authenticated";

revoke select on table "public"."funeral_policies" from "authenticated";

revoke trigger on table "public"."funeral_policies" from "authenticated";

revoke truncate on table "public"."funeral_policies" from "authenticated";

revoke update on table "public"."funeral_policies" from "authenticated";

revoke delete on table "public"."funeral_policies" from "service_role";

revoke insert on table "public"."funeral_policies" from "service_role";

revoke references on table "public"."funeral_policies" from "service_role";

revoke select on table "public"."funeral_policies" from "service_role";

revoke trigger on table "public"."funeral_policies" from "service_role";

revoke truncate on table "public"."funeral_policies" from "service_role";

revoke update on table "public"."funeral_policies" from "service_role";

revoke delete on table "public"."life_insurance_policies" from "anon";

revoke insert on table "public"."life_insurance_policies" from "anon";

revoke references on table "public"."life_insurance_policies" from "anon";

revoke select on table "public"."life_insurance_policies" from "anon";

revoke trigger on table "public"."life_insurance_policies" from "anon";

revoke truncate on table "public"."life_insurance_policies" from "anon";

revoke update on table "public"."life_insurance_policies" from "anon";

revoke delete on table "public"."life_insurance_policies" from "authenticated";

revoke insert on table "public"."life_insurance_policies" from "authenticated";

revoke references on table "public"."life_insurance_policies" from "authenticated";

revoke select on table "public"."life_insurance_policies" from "authenticated";

revoke trigger on table "public"."life_insurance_policies" from "authenticated";

revoke truncate on table "public"."life_insurance_policies" from "authenticated";

revoke update on table "public"."life_insurance_policies" from "authenticated";

revoke delete on table "public"."life_insurance_policies" from "service_role";

revoke insert on table "public"."life_insurance_policies" from "service_role";

revoke references on table "public"."life_insurance_policies" from "service_role";

revoke select on table "public"."life_insurance_policies" from "service_role";

revoke trigger on table "public"."life_insurance_policies" from "service_role";

revoke truncate on table "public"."life_insurance_policies" from "service_role";

revoke update on table "public"."life_insurance_policies" from "service_role";

revoke delete on table "public"."loan_payments" from "anon";

revoke insert on table "public"."loan_payments" from "anon";

revoke references on table "public"."loan_payments" from "anon";

revoke select on table "public"."loan_payments" from "anon";

revoke trigger on table "public"."loan_payments" from "anon";

revoke truncate on table "public"."loan_payments" from "anon";

revoke update on table "public"."loan_payments" from "anon";

revoke delete on table "public"."loan_payments" from "authenticated";

revoke insert on table "public"."loan_payments" from "authenticated";

revoke references on table "public"."loan_payments" from "authenticated";

revoke select on table "public"."loan_payments" from "authenticated";

revoke trigger on table "public"."loan_payments" from "authenticated";

revoke truncate on table "public"."loan_payments" from "authenticated";

revoke update on table "public"."loan_payments" from "authenticated";

revoke delete on table "public"."loan_payments" from "service_role";

revoke insert on table "public"."loan_payments" from "service_role";

revoke references on table "public"."loan_payments" from "service_role";

revoke select on table "public"."loan_payments" from "service_role";

revoke trigger on table "public"."loan_payments" from "service_role";

revoke truncate on table "public"."loan_payments" from "service_role";

revoke update on table "public"."loan_payments" from "service_role";

revoke delete on table "public"."otv_checks" from "anon";

revoke insert on table "public"."otv_checks" from "anon";

revoke references on table "public"."otv_checks" from "anon";

revoke select on table "public"."otv_checks" from "anon";

revoke trigger on table "public"."otv_checks" from "anon";

revoke truncate on table "public"."otv_checks" from "anon";

revoke update on table "public"."otv_checks" from "anon";

revoke delete on table "public"."otv_checks" from "authenticated";

revoke insert on table "public"."otv_checks" from "authenticated";

revoke references on table "public"."otv_checks" from "authenticated";

revoke select on table "public"."otv_checks" from "authenticated";

revoke trigger on table "public"."otv_checks" from "authenticated";

revoke truncate on table "public"."otv_checks" from "authenticated";

revoke update on table "public"."otv_checks" from "authenticated";

revoke delete on table "public"."otv_checks" from "service_role";

revoke insert on table "public"."otv_checks" from "service_role";

revoke references on table "public"."otv_checks" from "service_role";

revoke select on table "public"."otv_checks" from "service_role";

revoke trigger on table "public"."otv_checks" from "service_role";

revoke truncate on table "public"."otv_checks" from "service_role";

revoke update on table "public"."otv_checks" from "service_role";

revoke delete on table "public"."parties" from "anon";

revoke insert on table "public"."parties" from "anon";

revoke references on table "public"."parties" from "anon";

revoke select on table "public"."parties" from "anon";

revoke trigger on table "public"."parties" from "anon";

revoke truncate on table "public"."parties" from "anon";

revoke update on table "public"."parties" from "anon";

revoke delete on table "public"."parties" from "authenticated";

revoke insert on table "public"."parties" from "authenticated";

revoke references on table "public"."parties" from "authenticated";

revoke select on table "public"."parties" from "authenticated";

revoke trigger on table "public"."parties" from "authenticated";

revoke truncate on table "public"."parties" from "authenticated";

revoke update on table "public"."parties" from "authenticated";

revoke delete on table "public"."parties" from "service_role";

revoke insert on table "public"."parties" from "service_role";

revoke references on table "public"."parties" from "service_role";

revoke select on table "public"."parties" from "service_role";

revoke trigger on table "public"."parties" from "service_role";

revoke truncate on table "public"."parties" from "service_role";

revoke update on table "public"."parties" from "service_role";

revoke delete on table "public"."policies" from "anon";

revoke insert on table "public"."policies" from "anon";

revoke references on table "public"."policies" from "anon";

revoke select on table "public"."policies" from "anon";

revoke trigger on table "public"."policies" from "anon";

revoke truncate on table "public"."policies" from "anon";

revoke update on table "public"."policies" from "anon";

revoke delete on table "public"."policies" from "authenticated";

revoke insert on table "public"."policies" from "authenticated";

revoke references on table "public"."policies" from "authenticated";

revoke select on table "public"."policies" from "authenticated";

revoke trigger on table "public"."policies" from "authenticated";

revoke truncate on table "public"."policies" from "authenticated";

revoke update on table "public"."policies" from "authenticated";

revoke delete on table "public"."policies" from "service_role";

revoke insert on table "public"."policies" from "service_role";

revoke references on table "public"."policies" from "service_role";

revoke select on table "public"."policies" from "service_role";

revoke trigger on table "public"."policies" from "service_role";

revoke truncate on table "public"."policies" from "service_role";

revoke update on table "public"."policies" from "service_role";

revoke delete on table "public"."policy_beneficiaries" from "anon";

revoke insert on table "public"."policy_beneficiaries" from "anon";

revoke references on table "public"."policy_beneficiaries" from "anon";

revoke select on table "public"."policy_beneficiaries" from "anon";

revoke trigger on table "public"."policy_beneficiaries" from "anon";

revoke truncate on table "public"."policy_beneficiaries" from "anon";

revoke update on table "public"."policy_beneficiaries" from "anon";

revoke delete on table "public"."policy_beneficiaries" from "authenticated";

revoke insert on table "public"."policy_beneficiaries" from "authenticated";

revoke references on table "public"."policy_beneficiaries" from "authenticated";

revoke select on table "public"."policy_beneficiaries" from "authenticated";

revoke trigger on table "public"."policy_beneficiaries" from "authenticated";

revoke truncate on table "public"."policy_beneficiaries" from "authenticated";

revoke update on table "public"."policy_beneficiaries" from "authenticated";

revoke delete on table "public"."policy_beneficiaries" from "service_role";

revoke insert on table "public"."policy_beneficiaries" from "service_role";

revoke references on table "public"."policy_beneficiaries" from "service_role";

revoke select on table "public"."policy_beneficiaries" from "service_role";

revoke trigger on table "public"."policy_beneficiaries" from "service_role";

revoke truncate on table "public"."policy_beneficiaries" from "service_role";

revoke update on table "public"."policy_beneficiaries" from "service_role";

revoke delete on table "public"."policy_versions" from "anon";

revoke insert on table "public"."policy_versions" from "anon";

revoke references on table "public"."policy_versions" from "anon";

revoke select on table "public"."policy_versions" from "anon";

revoke trigger on table "public"."policy_versions" from "anon";

revoke truncate on table "public"."policy_versions" from "anon";

revoke update on table "public"."policy_versions" from "anon";

revoke delete on table "public"."policy_versions" from "authenticated";

revoke insert on table "public"."policy_versions" from "authenticated";

revoke references on table "public"."policy_versions" from "authenticated";

revoke select on table "public"."policy_versions" from "authenticated";

revoke trigger on table "public"."policy_versions" from "authenticated";

revoke truncate on table "public"."policy_versions" from "authenticated";

revoke update on table "public"."policy_versions" from "authenticated";

revoke delete on table "public"."policy_versions" from "service_role";

revoke insert on table "public"."policy_versions" from "service_role";

revoke references on table "public"."policy_versions" from "service_role";

revoke select on table "public"."policy_versions" from "service_role";

revoke trigger on table "public"."policy_versions" from "service_role";

revoke truncate on table "public"."policy_versions" from "service_role";

revoke update on table "public"."policy_versions" from "service_role";

revoke delete on table "public"."product_types" from "anon";

revoke insert on table "public"."product_types" from "anon";

revoke references on table "public"."product_types" from "anon";

revoke select on table "public"."product_types" from "anon";

revoke trigger on table "public"."product_types" from "anon";

revoke truncate on table "public"."product_types" from "anon";

revoke update on table "public"."product_types" from "anon";

revoke delete on table "public"."product_types" from "authenticated";

revoke insert on table "public"."product_types" from "authenticated";

revoke references on table "public"."product_types" from "authenticated";

revoke select on table "public"."product_types" from "authenticated";

revoke trigger on table "public"."product_types" from "authenticated";

revoke truncate on table "public"."product_types" from "authenticated";

revoke update on table "public"."product_types" from "authenticated";

revoke delete on table "public"."product_types" from "service_role";

revoke insert on table "public"."product_types" from "service_role";

revoke references on table "public"."product_types" from "service_role";

revoke select on table "public"."product_types" from "service_role";

revoke trigger on table "public"."product_types" from "service_role";

revoke truncate on table "public"."product_types" from "service_role";

revoke update on table "public"."product_types" from "service_role";

revoke delete on table "public"."profile_documents" from "anon";

revoke insert on table "public"."profile_documents" from "anon";

revoke references on table "public"."profile_documents" from "anon";

revoke select on table "public"."profile_documents" from "anon";

revoke trigger on table "public"."profile_documents" from "anon";

revoke truncate on table "public"."profile_documents" from "anon";

revoke update on table "public"."profile_documents" from "anon";

revoke delete on table "public"."profile_documents" from "authenticated";

revoke insert on table "public"."profile_documents" from "authenticated";

revoke references on table "public"."profile_documents" from "authenticated";

revoke select on table "public"."profile_documents" from "authenticated";

revoke trigger on table "public"."profile_documents" from "authenticated";

revoke truncate on table "public"."profile_documents" from "authenticated";

revoke update on table "public"."profile_documents" from "authenticated";

revoke delete on table "public"."profile_documents" from "service_role";

revoke insert on table "public"."profile_documents" from "service_role";

revoke references on table "public"."profile_documents" from "service_role";

revoke select on table "public"."profile_documents" from "service_role";

revoke trigger on table "public"."profile_documents" from "service_role";

revoke truncate on table "public"."profile_documents" from "service_role";

revoke update on table "public"."profile_documents" from "service_role";

revoke delete on table "public"."profiles" from "anon";

revoke insert on table "public"."profiles" from "anon";

revoke references on table "public"."profiles" from "anon";

revoke select on table "public"."profiles" from "anon";

revoke trigger on table "public"."profiles" from "anon";

revoke truncate on table "public"."profiles" from "anon";

revoke update on table "public"."profiles" from "anon";

revoke delete on table "public"."profiles" from "authenticated";

revoke insert on table "public"."profiles" from "authenticated";

revoke references on table "public"."profiles" from "authenticated";

revoke select on table "public"."profiles" from "authenticated";

revoke trigger on table "public"."profiles" from "authenticated";

revoke truncate on table "public"."profiles" from "authenticated";

revoke update on table "public"."profiles" from "authenticated";

revoke delete on table "public"."profiles" from "service_role";

revoke insert on table "public"."profiles" from "service_role";

revoke references on table "public"."profiles" from "service_role";

revoke select on table "public"."profiles" from "service_role";

revoke trigger on table "public"."profiles" from "service_role";

revoke truncate on table "public"."profiles" from "service_role";

revoke update on table "public"."profiles" from "service_role";

revoke delete on table "public"."transactions" from "anon";

revoke insert on table "public"."transactions" from "anon";

revoke references on table "public"."transactions" from "anon";

revoke select on table "public"."transactions" from "anon";

revoke trigger on table "public"."transactions" from "anon";

revoke truncate on table "public"."transactions" from "anon";

revoke update on table "public"."transactions" from "anon";

revoke delete on table "public"."transactions" from "authenticated";

revoke insert on table "public"."transactions" from "authenticated";

revoke references on table "public"."transactions" from "authenticated";

revoke select on table "public"."transactions" from "authenticated";

revoke trigger on table "public"."transactions" from "authenticated";

revoke truncate on table "public"."transactions" from "authenticated";

revoke update on table "public"."transactions" from "authenticated";

revoke delete on table "public"."transactions" from "service_role";

revoke insert on table "public"."transactions" from "service_role";

revoke references on table "public"."transactions" from "service_role";

revoke select on table "public"."transactions" from "service_role";

revoke trigger on table "public"."transactions" from "service_role";

revoke truncate on table "public"."transactions" from "service_role";

revoke update on table "public"."transactions" from "service_role";

set check_function_bodies = off;

CREATE OR REPLACE FUNCTION public.handle_new_user()
 RETURNS trigger
 LANGUAGE plpgsql
 SECURITY DEFINER
 SET search_path TO ''
AS $function$
begin
  insert into public.profiles (id, full_name, email, phone_number)
  values (new.id, new.raw_user_meta_data->>'full_name', new.email, new.raw_user_meta_data->>'phone_number');
  return new;
end;
$function$
;

CREATE OR REPLACE FUNCTION public.handle_new_user_signup(user_id uuid, user_full_name text)
 RETURNS void
 LANGUAGE plpgsql
 SECURITY DEFINER
 SET search_path TO ''
AS $function$
DECLARE
    user_email text;
BEGIN
    -- Get the email from auth.users table
    SELECT email INTO user_email
    FROM auth.users
    WHERE id = user_id;
    
    -- Insert into profiles with the email
    INSERT INTO public.profiles (id, full_name, email, role)
    VALUES (user_id, user_full_name, user_email, 'customer');
END;
$function$
;

CREATE OR REPLACE FUNCTION public.handle_new_user_signup(user_id uuid, user_full_name text, phone_number text)
 RETURNS void
 LANGUAGE plpgsql
 SECURITY DEFINER
 SET search_path TO ''
AS $function$
DECLARE
    user_email text;
BEGIN
    -- Get the email from auth.users table
    SELECT email INTO user_email
    FROM auth.users
    WHERE id = user_id;
    
    -- Insert into profiles with the email and phone number
    INSERT INTO public.profiles (id, full_name, email, phone_number, role)
    VALUES (user_id, user_full_name, user_email, phone_number, 'customer');
END;
$function$
;


